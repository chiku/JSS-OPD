var Application={Models:{},Collections:{},collections:{},Routers:{},Views:{},Configuration:{Urls:{},Selectors:{}},initialize:function(){new Application.Routers.Patients();Backbone.history.start();Application.collections.patients.fetch()}};Application.Configuration.Selectors={main:'body div[role="main"]',appointments:"#appointments",patients:"#patients-container",patientDetails:"#patient-details-container",pateintsSort:"#pateints-sort",templates:{patients:"#template-patients",patient:"#template-patient",patientDetails:"#template-patient-details"}};Application.Configuration.Urls={patients:"/patients.json"};Application.Models.Patient=Backbone.Model.extend({});Application.Collections.Patients=Backbone.Collection.extend({model:Application.Models.Patient,url:Application.Configuration.Urls.patients,parse:function(a){return a.patients},comparator:function(a){return a.get("name")},reorderBy:function(a){this.comparator=function(b){return b.get(a)};this.sort();return this}});Application.collections.patients=new Application.Collections.Patients;Application.Routers.Patients=Backbone.Router.extend({routes:{"":"index",patients:"index","patients/:id":"show"},initialize:function(){this.patientsView=new Application.Views.Patients.Index({collection:Application.collections.patients})},index:function(){this.patientsView.attachContentToCleanContainer()},show:function(a){}});Application.Views.Patients||(Application.Views.Patients={});Application.Views.Patients.Index=Backbone.View.extend({tagName:"section",className:"patients",template:function(){return _.template(jQuery(this.selectors.templates.patients).html())},initialize:function(a){this.collection.bind("reset",this.render,this);this.selectors=Application.Configuration.Selectors;new Application.Views.Patients.Sort({collection:this.collection})},render:function(){jQuery(this.el).html(this.template({}));this.collection.each(function(b){var a=new Application.Views.Patients.Info({model:b});jQuery(this.selectors.patients).append(a.render().el)},this);return this},attachContentToCleanContainer:function(){jQuery(this.selectors.appointments).empty().append(this.render().el);return this}});Application.Views.Patients||(Application.Views.Patients={});Application.Views.Patients.Info=Backbone.View.extend({tagName:"li",className:"patient",events:{click:"showDetails"},template:function(){return _.template(jQuery(Application.Configuration.Selectors.templates.patient).html())},initialize:function(a){this.model.bind("change",this.render,this);this.detailedView=new Application.Views.Patients.Show({model:this.model})},render:function(){var a=this.template()(this.model.toJSON());jQuery(this.el).html(a);return this},showDetails:function(){this.detailedView.attachContentToCleanContainer()}});Application.Views.Patients||(Application.Views.Patients={});Application.Views.Patients.Show=Backbone.View.extend({tagName:"ul",className:"patient-details",template:function(){return _.template(jQuery(this.selectors.templates.patientDetails).html())},initialize:function(a){this.model.bind("change",this.attachContentToCleanContainer,this);this.selectors=Application.Configuration.Selectors},render:function(){var a=this.template()(this.model.toJSON());jQuery(this.el).html(a);return this},attachContentToCleanContainer:function(){jQuery(this.selectors.patientDetails).empty().append(this.render().el);return this}});Application.Views.Patients||(Application.Views.Patients={});Application.Views.Patients.Sort=Backbone.View.extend({el:function(){return $(Application.Configuration.Selectors.pateintsSort)},events:{click:"sortPatients"},initialize:function(a){},sortPatients:function(b){var a=jQuery(b.target).attr("data-sort-by");this.collection.reorderBy(a)}});jQuery(function(){var b=Application.Configuration.Selectors;var a=jQuery(b.main);jQuery("<section>",{id:b.appointments.replace("#","")}).appendTo(a);jQuery("<section>",{id:b.patientDetails.replace("#","")}).appendTo(a);Application.initialize()});