var Application={Models:{},Collections:{},collections:{},Router:undefined,Views:{Encounters:{},Patients:{}},Configuration:{Urls:{},Selectors:{}},initialize:function(){new Application.Router();Backbone.history.start();Application.collections.encounters.fetch()}};Application.Configuration.Selectors={main:'body div[role="main"]',appointments:"#appointments",encounters:"#encounters-container",patient:"#patient-container",encountersSort:"#encounters-sort",templates:{encounters:"#template-encounters",encounter:"#template-encounter",patient:"#template-patient"}};Application.Configuration.Urls={encounters:"/sampleWSResponses/encounter.json",patients:"/sampleWSResponses/patient.json"};Application.Models.Encounter=Backbone.Model.extend({});Application.Models.Patient=Backbone.Model.extend({});Application.Collections.Encounters=Backbone.Collection.extend({model:Application.Models.Encounter,url:Application.Configuration.Urls.encounters,parse:function(a){var b=a.results;_(b).each(function(c){c.id=c.uuid});return b},comparator:function(a){return a.get("name")},reorderBy:function(a){this.comparator=function(b){return b.get(a)};this.sort();return this}});Application.collections.encounters=new Application.Collections.Encounters;Application.Router=Backbone.Router.extend({routes:{"":"index",encounters:"index","patients/:id":"show"},initialize:function(){this.encountersView=new Application.Views.Encounters.Index({collection:Application.collections.encounters,encounterShowsContainerSelector:Application.Configuration.Selectors.encounters})},index:function(){this.encountersView.attachContentToCleanContainer()},show:function(a){}});jQuery(function(){Application.Views.Encounters.Index=Backbone.View.extend({tagName:"section",className:"encounters",template:jQuery(Application.Configuration.Selectors.templates.encounters).html(),initialize:function(a){this.encounterShowsContainerSelector=a.encounterShowsContainerSelector;this.collection.bind("reset",this.render,this);new Application.Views.Encounters.Sort({collection:this.collection})},render:function(){jQuery(this.el).html(_.template(this.template));this.collection.each(function(a){var b=new Application.Views.Encounters.Show({model:a});jQuery(this.encounterShowsContainerSelector).append(b.render().el)},this);return this},attachContentToCleanContainer:function(){jQuery(Application.Configuration.Selectors.appointments).empty().append(this.render().el);return this}})});jQuery(function(){Application.Views.Encounters.Show=Backbone.View.extend({tagName:"li",className:"encounter",events:{click:"showDetails"},template:jQuery(Application.Configuration.Selectors.templates.patient).html(),initialize:function(a){this.model.bind("change",this.render,this);this.detailedView=new Application.Views.Patients.Show({model:this.model})},render:function(){var a=_.template(this.template)(this.model.toJSON());jQuery(this.el).html(a);return this},showDetails:function(){this.detailedView.attachContentToCleanContainer()}})});jQuery(function(){Application.Views.Patients.Show=Backbone.View.extend({tagName:"ul",className:"patient",template:jQuery(Application.Configuration.Selectors.templates.patient).html(),initialize:function(a){this.model.bind("change",this.attachContentToCleanContainer,this)},render:function(){var a=_.template(this.template)(this.model.toJSON());jQuery(this.el).html(a);return this},attachContentToCleanContainer:function(){jQuery(Application.Configuration.Selectors.patient).empty().append(this.render().el);return this}})});jQuery(function(){Application.Views.Encounters.Sort=Backbone.View.extend({el:jQuery(Application.Configuration.Selectors.encountersSort),events:{click:"sortPatients"},sortPatients:function(b){var a=jQuery(b.target).attr("data-sort-by");this.collection.reorderBy(a)}})});jQuery(function(){var b=Application.Configuration.Selectors;var a=jQuery(b.main);jQuery("<section>",{id:b.appointments.replace("#","")}).appendTo(a);jQuery("<section>",{id:b.patient.replace("#","")}).appendTo(a);Application.initialize()});